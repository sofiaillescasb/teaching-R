colnames(data[,colSums(is.na(data)) > 0])
# In this case we'll ignore missing values, but we could use more sophisticated methods to impute them
data <- na.omit(data)
data %>%
ggplot(aes(x=Age,fill=Survived)) +
geom_histogram()
data
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
if(!require(here)) install.packages("here")
if(!require(qwraps2)) install.packages("qwraps2")
if(!require(here)) install.packages("readxl")
if(!require(qwraps2)) install.packages("writexl")
if(!require(tidyverse)) install.packages("tidyverse")
library(here)
library(qwraps2)
library(readxl)
library(writexl)
library(tidyverse)
dbset <- read_excel(here("dataset/titanic_dataset.xlsx"))
#Inspecting data
head(dbset)
head(dbset[,"Name"])
head(dbset[["Name"]])
head(dbset$Name)
#Subsetting
dbset[dbset$Sex=="female"&dbset$Pclass==1,]
subset(dbset, Sex=="female"&Pclass==1)
#Change variable types if they don't make sense
# "Age" should be a number, not characters
dbset$Age <- as.numeric(dbset$Age)
# "Survived" should be a factor meaning yes/no, instead of a numeric value
dbset$Survived <- factor(dbset$Survived)
cat("Survival by sex:", sep = "\n")
cat("", sep = "\n")
xtabs(~Sex+Survived,data = dbset)
cat("", sep = "\n")
cat("Survival by class:", sep = "\n")
cat("", sep = "\n")
xtabs(~Pclass+Survived,data = dbset)
cat("", sep = "\n")
cat("Male survival by class:", sep = "\n")
cat("", sep = "\n")
xtabs(~Pclass+Survived,data = dbset,subset = Sex=="male")
cat("", sep = "\n")
cat("Female survival by class:", sep = "\n")
cat("", sep = "\n")
xtabs(~Pclass+Survived,data = dbset,subset = Sex=="female")
cat("", sep = "\n")
# We can't use missing values, so we eliminate all columns with more than 80% NAs
data <- dbset[,colSums(is.na(dbset)) < length(rownames(dbset))*0.2]
colnames(data[,colSums(is.na(data)) > 0])
# In this case we'll ignore missing values, but we could use more sophisticated methods to impute them
data <- na.omit(data)
data %>%
ggplot(aes(x=Age,fill=Survived)) +
geom_histogram()
# For continuous variables raw
variable_names <- "Age"
# Create a list to store summary statistics
summary_list <- list()
# Iterate over the variable names to compute statistics
for (variable in variable_names) {
summary_list[[variable]] <- list(
"min" = as.formula(paste0("~ min(`", variable, "`)")),
"median (iqr)" = as.formula(paste0("~ median_iqr(`", variable, "`)")),
"max" = as.formula(paste0("~ max(`", variable, "`)")),
"mean (CI)" = as.formula(paste0("~ qwraps2::frmtci(mean_ci(`", variable, "`, show_level = TRUE))")),
"SD" = as.formula(paste0("~ sd(`", variable, "`)"))
)
}
# Create a summary table
summary_table_data <- summary_table(dplyr::group_by(data, Sex, Survived), summary_list)# Let's group passengers by survival, 0=died, 1=survived
rownames_summary <- rownames(summary_table_data)
summary_table_data <- data.frame(cbind(rep(variable_names, each = 5), summary_table_data), check.names = FALSE) #change for the number of statistics to calculate
colnames(summary_table_data)[1] <- "Variable" #Change to name that makes sense
summary_table_data <- rownames_to_column(summary_table_data, var = "Statistic")
summary_table_data$Statistic <- rownames_summary
# Pivot the data for a wider format
summary_statistics_grouped <- pivot_wider(summary_table_data, names_from = Variable, values_from = colnames(summary_table_data)[-c(1, 2)])
View(summary_statistics_grouped)
data %>%
ggplot(aes(x=Age,group=Survived,fill=Sex)) +
geom_histogram()
women <- subset(data, Sex=="female")
men <- subset(data, Sex=="male")
women %>%
ggplot(aes(x=Age,fill=Survived)) +
geom_histogram()
men %>%
ggplot(aes(x=Age,fill=Survived)) +
geom_histogram()
survivors <- subset(data, Survived==1)
survivors %>%
ggplot(aes(x=Age,fill=Sex)) +
geom_histogram()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram()
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
if(!require(here)) install.packages("here")
if(!require(qwraps2)) install.packages("qwraps2")
if(!require(here)) install.packages("readxl")
if(!require(qwraps2)) install.packages("writexl")
if(!require(tidyverse)) install.packages("tidyverse")
library(here)
library(qwraps2)
library(readxl)
library(writexl)
library(tidyverse)
dbset <- read_excel(here("dataset/titanic_dataset.xlsx"))
#Inspecting data
head(dbset)
head(dbset[,"Name"])
head(dbset[["Name"]])
head(dbset$Name)
#Subsetting
dbset[dbset$Sex=="female"&dbset$Pclass==1,]
subset(dbset, Sex=="female"&Pclass==1)
#Change variable types if they don't make sense
# "Age" should be a number, not characters
dbset$Age <- as.numeric(dbset$Age)
# "Survived" should be a factor meaning yes/no, instead of a numeric value
dbset$Survived <- factor(dbset$Survived)
# "Pclass" should also be a factor instead of a number
dbset$Pclass <- factor(dbset$Pclass)
cat("Survival by sex:", sep = "\n")
cat("", sep = "\n")
xtabs(~Sex+Survived,data = dbset)
cat("", sep = "\n")
cat("Survival by class:", sep = "\n")
cat("", sep = "\n")
xtabs(~Pclass+Survived,data = dbset)
cat("", sep = "\n")
cat("Male survival by class:", sep = "\n")
cat("", sep = "\n")
xtabs(~Pclass+Survived,data = dbset,subset = Sex=="male")
cat("", sep = "\n")
cat("Female survival by class:", sep = "\n")
cat("", sep = "\n")
xtabs(~Pclass+Survived,data = dbset,subset = Sex=="female")
cat("", sep = "\n")
# We can't use missing values, so we eliminate all columns with more than 80% NAs
data <- dbset[,colSums(is.na(dbset)) < length(rownames(dbset))*0.2]
colnames(data[,colSums(is.na(data)) > 0])
# In this case we'll ignore missing values, but we could use more sophisticated methods to impute them
data <- na.omit(data)
survivors <- subset(data, Survived==1)
survivors %>%
ggplot(aes(x=Age,fill=Sex)) +
geom_histogram()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram()
# For continuous variables raw
variable_names <- "Age"
# Create a list to store summary statistics
summary_list <- list()
# Iterate over the variable names to compute statistics
for (variable in variable_names) {
summary_list[[variable]] <- list(
"min" = as.formula(paste0("~ min(`", variable, "`)")),
"median (iqr)" = as.formula(paste0("~ median_iqr(`", variable, "`)")),
"max" = as.formula(paste0("~ max(`", variable, "`)")),
"mean (CI)" = as.formula(paste0("~ qwraps2::frmtci(mean_ci(`", variable, "`, show_level = TRUE))")),
"SD" = as.formula(paste0("~ sd(`", variable, "`)"))
)
}
# Create a summary table
summary_table_data <- summary_table(dplyr::group_by(data, Sex, Survived), summary_list)# Let's group passengers by survival, 0=died, 1=survived
rownames_summary <- rownames(summary_table_data)
summary_table_data <- data.frame(cbind(rep(variable_names, each = 5), summary_table_data), check.names = FALSE) #change for the number of statistics to calculate
colnames(summary_table_data)[1] <- "Variable" #Change to name that makes sense
summary_table_data <- rownames_to_column(summary_table_data, var = "Statistic")
summary_table_data$Statistic <- rownames_summary
# Pivot the data for a wider format
summary_statistics_grouped <- pivot_wider(summary_table_data, names_from = Variable, values_from = colnames(summary_table_data)[-c(1, 2)])
View(summary_statistics_grouped)
data %>%
ggplot(aes(x=Survived,fill=Pclass)) +
geom_histogram()
survivors <- subset(data, Survived==1)
survivors %>%
ggplot(aes(x=Age,fill=Sex)) +
geom_histogram()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_freqpoly()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram() +
geom_density(alpha=0.3)
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram() +
geom_density(alpha=0.3)
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram() +
geom_density()
survivors %>%
ggplot(aes(x=Age)) +
geom_histogram(fill=Pclass) +
geom_density()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram() +
geom_density()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram() +
geom_density(col="black")
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density()
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
survivors %>%
ggplot(aes(x=Age,fill=Sex)) +
geom_density(alpha=0.3)
survivors <- subset(data, Survived==1)
casualties <- subset(data, Survived==0)
survivors %>%
ggplot(aes(x=Age,fill=Sex)) +
geom_density(alpha=0.3)
survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
casualties %>%
ggplot(aes(x=Age,fill=Sex)) +
geom_density(alpha=0.3)
casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age)) +
geom_density(alpha=0.3)
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
male_survivors %>%
ggplot(aes(x=Age)) +
geom_density(alpha=0.3)
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age)) +
geom_histogram()
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(alpha=0.3)
male_survivors %>%
ggplot(aes(x=Age)) +
geom_histogram()
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(alpha=0.3)
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age)) +
geom_density()
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
male_survivors %>%
ggplot(aes(x=Age)) +
geom_density()
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_hist(alpha=0.3)
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age)) +
geom_density()
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
male_survivors %>%
ggplot(aes(x=Age)) +
geom_density()
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3)
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(alpha=0.3)
female_casualties
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(alpha=0.3)
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age)) +
geom_histogram()
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(alpha=0.3)
male_survivors %>%
ggplot(aes(x=Age)) +
geom_histogram()
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(alpha=0.3)
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(alpha=0.3, binwidth = 1)
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age)) +
geom_histogram()
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(binwidth = 1)
male_survivors %>%
ggplot(aes(x=Age)) +
geom_histogram(binwidth = 1)
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(binwidth = 1)
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(binwidth = 1)
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(binwidth = 1)
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(binwidth = 1) +
labs(title = "Female casualties distribution", x = "Age", y = "Count", fill = "Passenger class")
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_histogram(binwidth = 1) +
labs(title = "Male survivors distribution", x = "Age", y = "Count", fill = "Passenger class")
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density()+
labs(title = "Male survivors distribution", x = "Age", y = "Count", fill = "Passenger class")
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3) +
labs(title = "Male survivors distribution", x = "Age", y = "Count", fill = "Passenger class")
female_casualties <- subset(data, Sex=="female"&Survived==0)
male_survivors <- subset(data, Sex=="male"&Survived==1)
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3) +
labs(title = "Female casualties distribution", x = "Age", y = "Count", fill = "Passenger class")
male_survivors %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3) +
labs(title = "Male survivors distribution", x = "Age", y = "Count", fill = "Passenger class")
all_casualties %>%
ggplot(aes(x=x)) +
geom_density(aes(x=Age,y = ..density..),alpha=0.3) +
geom_density(aes(x=Age,y = -..density..),alpha=0.3)
all_survivors <- subset(data, Survived==1)
all_casualties <- subset(data, Survived==0)
all_casualties %>%
ggplot(aes(x=x)) +
geom_density(aes(x=Age,y = ..density..),alpha=0.3) +
geom_density(aes(x=Age,y = -..density..),alpha=0.3)
all_casualties %>%
ggplot(aes(x=x)) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3)
all_casualties %>%
ggplot(aes(x=x,fill=Sex)) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3)
all_casualties %>%
ggplot(aes(x=x,fill=Sex)) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3, data=subset(all_casualties, Sex=="female")) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3, data=subset(all_casualties, Sex=="male"))
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3, data=subset(all_casualties, Sex=="female")) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3, data=subset(all_casualties, Sex=="male"))
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3, data=subset(data, Sex=="female")) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3, data=subset(data, Sex=="male"))
ggplot(aes(x=x,fill=Sex), dara=data) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3, data=subset(data, Sex=="female")) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3, data=subset(data, Sex=="male"))
ggplot(aes(x=x,fill=Sex), data=data) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3, data=subset(data, Sex=="female")) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3, data=subset(data, Sex=="male"))
ggplot(aes(x=x,fill=Sex)) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3, data=subset(data, Sex=="female")) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3, data=subset(data, Sex=="male"))
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_density(aes(x=Age,y = after_stat(density)),alpha=0.3, data=subset(data, Sex=="female")) +
geom_density(aes(x=Age,y = -after_stat(density)),alpha=0.3, data=subset(data, Sex=="male"))
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(density)),alpha=0.3, data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(density)),alpha=0.3, data=subset(data, Sex=="male"))
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count)),alpha=0.3, data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)),alpha=0.3, data=subset(data, Sex=="male"))
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count)), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)), data=subset(data, Sex=="male"))
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count)), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)), data=subset(data, Sex=="male")) +
coord_flip()
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count)), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)), data=subset(data, Sex=="male")) +
coord_flip() +
labs(x = "Age", y = "Count", fill = "Age", title = "Age distribution by sex")
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count)), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)), data=subset(data, Sex=="male")) +
coord_flip() +
scale_y_continuous(
labels = abs) +
labs(x = "Age", y = "Count", fill = "Age", title = "Age distribution by sex")
female_casualties %>%
ggplot(aes(x=Age,fill=Pclass)) +
geom_density(alpha=0.3) +
labs(title = "Female casualties distribution", x = "Age", y = "Count", fill = "Passenger class")
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count)), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)), data=subset(data, Sex=="male")) +
coord_flip() +
scale_y_continuous(
labels = abs) +
labs(x = "Age", y = "Count", fill = "Age", title = "Age distribution by sex")
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count)), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)), data=subset(data, Sex=="male")) +
coord_flip() +
theme_minimal() +
scale_y_continuous(
labels = abs
) +
labs(x = "Age", y = "Count", fill = "Age", title = "Age distribution by sex")
data %>%
ggplot(aes(x=x,fill=Sex, col="black")) +
geom_histogram(aes(x=Age,y = after_stat(count)), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)), data=subset(data, Sex=="male")) +
coord_flip() +
theme_minimal() +
scale_y_continuous(
labels = abs
) +
labs(x = "Age", y = "Count", fill = "Age", title = "Age distribution by sex")
data %>%
ggplot(aes(x=x,fill=Sex),col="black") +
geom_histogram(aes(x=Age,y = after_stat(count)), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)), data=subset(data, Sex=="male")) +
coord_flip() +
theme_minimal() +
scale_y_continuous(
labels = abs
) +
labs(x = "Age", y = "Count", fill = "Age", title = "Age distribution by sex")
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count),col="black"), data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count),,col="black"), data=subset(data, Sex=="male")) +
coord_flip() +
theme_minimal() +
scale_y_continuous(
labels = abs
) +
labs(x = "Age", y = "Count", fill = "Age", title = "Age distribution by sex")
data %>%
ggplot(aes(x=x,fill=Sex)) +
geom_histogram(aes(x=Age,y = after_stat(count)),col="black", data=subset(data, Sex=="female")) +
geom_histogram(aes(x=Age,y = -after_stat(count)),col="black", data=subset(data, Sex=="male")) +
coord_flip() +
theme_minimal() +
scale_y_continuous(
labels = abs
) +
labs(x = "Age", y = "Count", fill = "Age", title = "Age distribution by sex")
